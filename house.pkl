{"cells":[{"metadata":{},"cell_type":"markdown","source":"# Linear Regression on the Bostan Housing Prices Data"},{"metadata":{"_uuid":"d629ff2d2480ee46fbb7e2d37f6b5fab8052498a","_cell_guid":"79c7e3d0-c299-4dcb-8224-4455121ee9b0","trusted":true},"cell_type":"code","source":"import pandas as pd\nimport numpy as np\nimport sklearn as sc","execution_count":28,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.datasets import load_boston\nbostan=load_boston()\nbostan","execution_count":29,"outputs":[{"output_type":"execute_result","execution_count":29,"data":{"text/plain":"{'data': array([[6.3200e-03, 1.8000e+01, 2.3100e+00, ..., 1.5300e+01, 3.9690e+02,\n         4.9800e+00],\n        [2.7310e-02, 0.0000e+00, 7.0700e+00, ..., 1.7800e+01, 3.9690e+02,\n         9.1400e+00],\n        [2.7290e-02, 0.0000e+00, 7.0700e+00, ..., 1.7800e+01, 3.9283e+02,\n         4.0300e+00],\n        ...,\n        [6.0760e-02, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9690e+02,\n         5.6400e+00],\n        [1.0959e-01, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9345e+02,\n         6.4800e+00],\n        [4.7410e-02, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9690e+02,\n         7.8800e+00]]),\n 'target': array([24. , 21.6, 34.7, 33.4, 36.2, 28.7, 22.9, 27.1, 16.5, 18.9, 15. ,\n        18.9, 21.7, 20.4, 18.2, 19.9, 23.1, 17.5, 20.2, 18.2, 13.6, 19.6,\n        15.2, 14.5, 15.6, 13.9, 16.6, 14.8, 18.4, 21. , 12.7, 14.5, 13.2,\n        13.1, 13.5, 18.9, 20. , 21. , 24.7, 30.8, 34.9, 26.6, 25.3, 24.7,\n        21.2, 19.3, 20. , 16.6, 14.4, 19.4, 19.7, 20.5, 25. , 23.4, 18.9,\n        35.4, 24.7, 31.6, 23.3, 19.6, 18.7, 16. , 22.2, 25. , 33. , 23.5,\n        19.4, 22. , 17.4, 20.9, 24.2, 21.7, 22.8, 23.4, 24.1, 21.4, 20. ,\n        20.8, 21.2, 20.3, 28. , 23.9, 24.8, 22.9, 23.9, 26.6, 22.5, 22.2,\n        23.6, 28.7, 22.6, 22. , 22.9, 25. , 20.6, 28.4, 21.4, 38.7, 43.8,\n        33.2, 27.5, 26.5, 18.6, 19.3, 20.1, 19.5, 19.5, 20.4, 19.8, 19.4,\n        21.7, 22.8, 18.8, 18.7, 18.5, 18.3, 21.2, 19.2, 20.4, 19.3, 22. ,\n        20.3, 20.5, 17.3, 18.8, 21.4, 15.7, 16.2, 18. , 14.3, 19.2, 19.6,\n        23. , 18.4, 15.6, 18.1, 17.4, 17.1, 13.3, 17.8, 14. , 14.4, 13.4,\n        15.6, 11.8, 13.8, 15.6, 14.6, 17.8, 15.4, 21.5, 19.6, 15.3, 19.4,\n        17. , 15.6, 13.1, 41.3, 24.3, 23.3, 27. , 50. , 50. , 50. , 22.7,\n        25. , 50. , 23.8, 23.8, 22.3, 17.4, 19.1, 23.1, 23.6, 22.6, 29.4,\n        23.2, 24.6, 29.9, 37.2, 39.8, 36.2, 37.9, 32.5, 26.4, 29.6, 50. ,\n        32. , 29.8, 34.9, 37. , 30.5, 36.4, 31.1, 29.1, 50. , 33.3, 30.3,\n        34.6, 34.9, 32.9, 24.1, 42.3, 48.5, 50. , 22.6, 24.4, 22.5, 24.4,\n        20. , 21.7, 19.3, 22.4, 28.1, 23.7, 25. , 23.3, 28.7, 21.5, 23. ,\n        26.7, 21.7, 27.5, 30.1, 44.8, 50. , 37.6, 31.6, 46.7, 31.5, 24.3,\n        31.7, 41.7, 48.3, 29. , 24. , 25.1, 31.5, 23.7, 23.3, 22. , 20.1,\n        22.2, 23.7, 17.6, 18.5, 24.3, 20.5, 24.5, 26.2, 24.4, 24.8, 29.6,\n        42.8, 21.9, 20.9, 44. , 50. , 36. , 30.1, 33.8, 43.1, 48.8, 31. ,\n        36.5, 22.8, 30.7, 50. , 43.5, 20.7, 21.1, 25.2, 24.4, 35.2, 32.4,\n        32. , 33.2, 33.1, 29.1, 35.1, 45.4, 35.4, 46. , 50. , 32.2, 22. ,\n        20.1, 23.2, 22.3, 24.8, 28.5, 37.3, 27.9, 23.9, 21.7, 28.6, 27.1,\n        20.3, 22.5, 29. , 24.8, 22. , 26.4, 33.1, 36.1, 28.4, 33.4, 28.2,\n        22.8, 20.3, 16.1, 22.1, 19.4, 21.6, 23.8, 16.2, 17.8, 19.8, 23.1,\n        21. , 23.8, 23.1, 20.4, 18.5, 25. , 24.6, 23. , 22.2, 19.3, 22.6,\n        19.8, 17.1, 19.4, 22.2, 20.7, 21.1, 19.5, 18.5, 20.6, 19. , 18.7,\n        32.7, 16.5, 23.9, 31.2, 17.5, 17.2, 23.1, 24.5, 26.6, 22.9, 24.1,\n        18.6, 30.1, 18.2, 20.6, 17.8, 21.7, 22.7, 22.6, 25. , 19.9, 20.8,\n        16.8, 21.9, 27.5, 21.9, 23.1, 50. , 50. , 50. , 50. , 50. , 13.8,\n        13.8, 15. , 13.9, 13.3, 13.1, 10.2, 10.4, 10.9, 11.3, 12.3,  8.8,\n         7.2, 10.5,  7.4, 10.2, 11.5, 15.1, 23.2,  9.7, 13.8, 12.7, 13.1,\n        12.5,  8.5,  5. ,  6.3,  5.6,  7.2, 12.1,  8.3,  8.5,  5. , 11.9,\n        27.9, 17.2, 27.5, 15. , 17.2, 17.9, 16.3,  7. ,  7.2,  7.5, 10.4,\n         8.8,  8.4, 16.7, 14.2, 20.8, 13.4, 11.7,  8.3, 10.2, 10.9, 11. ,\n         9.5, 14.5, 14.1, 16.1, 14.3, 11.7, 13.4,  9.6,  8.7,  8.4, 12.8,\n        10.5, 17.1, 18.4, 15.4, 10.8, 11.8, 14.9, 12.6, 14.1, 13. , 13.4,\n        15.2, 16.1, 17.8, 14.9, 14.1, 12.7, 13.5, 14.9, 20. , 16.4, 17.7,\n        19.5, 20.2, 21.4, 19.9, 19. , 19.1, 19.1, 20.1, 19.9, 19.6, 23.2,\n        29.8, 13.8, 13.3, 16.7, 12. , 14.6, 21.4, 23. , 23.7, 25. , 21.8,\n        20.6, 21.2, 19.1, 20.6, 15.2,  7. ,  8.1, 13.6, 20.1, 21.8, 24.5,\n        23.1, 19.7, 18.3, 21.2, 17.5, 16.8, 22.4, 20.6, 23.9, 22. , 11.9]),\n 'feature_names': array(['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS', 'RAD',\n        'TAX', 'PTRATIO', 'B', 'LSTAT'], dtype='<U7'),\n 'DESCR': \".. _boston_dataset:\\n\\nBoston house prices dataset\\n---------------------------\\n\\n**Data Set Characteristics:**  \\n\\n    :Number of Instances: 506 \\n\\n    :Number of Attributes: 13 numeric/categorical predictive. Median Value (attribute 14) is usually the target.\\n\\n    :Attribute Information (in order):\\n        - CRIM     per capita crime rate by town\\n        - ZN       proportion of residential land zoned for lots over 25,000 sq.ft.\\n        - INDUS    proportion of non-retail business acres per town\\n        - CHAS     Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)\\n        - NOX      nitric oxides concentration (parts per 10 million)\\n        - RM       average number of rooms per dwelling\\n        - AGE      proportion of owner-occupied units built prior to 1940\\n        - DIS      weighted distances to five Boston employment centres\\n        - RAD      index of accessibility to radial highways\\n        - TAX      full-value property-tax rate per $10,000\\n        - PTRATIO  pupil-teacher ratio by town\\n        - B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town\\n        - LSTAT    % lower status of the population\\n        - MEDV     Median value of owner-occupied homes in $1000's\\n\\n    :Missing Attribute Values: None\\n\\n    :Creator: Harrison, D. and Rubinfeld, D.L.\\n\\nThis is a copy of UCI ML housing dataset.\\nhttps://archive.ics.uci.edu/ml/machine-learning-databases/housing/\\n\\n\\nThis dataset was taken from the StatLib library which is maintained at Carnegie Mellon University.\\n\\nThe Boston house-price data of Harrison, D. and Rubinfeld, D.L. 'Hedonic\\nprices and the demand for clean air', J. Environ. Economics & Management,\\nvol.5, 81-102, 1978.   Used in Belsley, Kuh & Welsch, 'Regression diagnostics\\n...', Wiley, 1980.   N.B. Various transformations are used in the table on\\npages 244-261 of the latter.\\n\\nThe Boston house-price data has been used in many machine learning papers that address regression\\nproblems.   \\n     \\n.. topic:: References\\n\\n   - Belsley, Kuh & Welsch, 'Regression diagnostics: Identifying Influential Data and Sources of Collinearity', Wiley, 1980. 244-261.\\n   - Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning. In Proceedings on the Tenth International Conference of Machine Learning, 236-243, University of Massachusetts, Amherst. Morgan Kaufmann.\\n\",\n 'filename': '/opt/conda/lib/python3.6/site-packages/sklearn/datasets/data/boston_house_prices.csv'}"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"bostan.keys()","execution_count":30,"outputs":[{"output_type":"execute_result","execution_count":30,"data":{"text/plain":"dict_keys(['data', 'target', 'feature_names', 'DESCR', 'filename'])"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"bostan.data","execution_count":31,"outputs":[{"output_type":"execute_result","execution_count":31,"data":{"text/plain":"array([[6.3200e-03, 1.8000e+01, 2.3100e+00, ..., 1.5300e+01, 3.9690e+02,\n        4.9800e+00],\n       [2.7310e-02, 0.0000e+00, 7.0700e+00, ..., 1.7800e+01, 3.9690e+02,\n        9.1400e+00],\n       [2.7290e-02, 0.0000e+00, 7.0700e+00, ..., 1.7800e+01, 3.9283e+02,\n        4.0300e+00],\n       ...,\n       [6.0760e-02, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9690e+02,\n        5.6400e+00],\n       [1.0959e-01, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9345e+02,\n        6.4800e+00],\n       [4.7410e-02, 0.0000e+00, 1.1930e+01, ..., 2.1000e+01, 3.9690e+02,\n        7.8800e+00]])"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"print(bostan.DESCR)","execution_count":32,"outputs":[{"output_type":"stream","text":".. _boston_dataset:\n\nBoston house prices dataset\n---------------------------\n\n**Data Set Characteristics:**  \n\n    :Number of Instances: 506 \n\n    :Number of Attributes: 13 numeric/categorical predictive. Median Value (attribute 14) is usually the target.\n\n    :Attribute Information (in order):\n        - CRIM     per capita crime rate by town\n        - ZN       proportion of residential land zoned for lots over 25,000 sq.ft.\n        - INDUS    proportion of non-retail business acres per town\n        - CHAS     Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)\n        - NOX      nitric oxides concentration (parts per 10 million)\n        - RM       average number of rooms per dwelling\n        - AGE      proportion of owner-occupied units built prior to 1940\n        - DIS      weighted distances to five Boston employment centres\n        - RAD      index of accessibility to radial highways\n        - TAX      full-value property-tax rate per $10,000\n        - PTRATIO  pupil-teacher ratio by town\n        - B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town\n        - LSTAT    % lower status of the population\n        - MEDV     Median value of owner-occupied homes in $1000's\n\n    :Missing Attribute Values: None\n\n    :Creator: Harrison, D. and Rubinfeld, D.L.\n\nThis is a copy of UCI ML housing dataset.\nhttps://archive.ics.uci.edu/ml/machine-learning-databases/housing/\n\n\nThis dataset was taken from the StatLib library which is maintained at Carnegie Mellon University.\n\nThe Boston house-price data of Harrison, D. and Rubinfeld, D.L. 'Hedonic\nprices and the demand for clean air', J. Environ. Economics & Management,\nvol.5, 81-102, 1978.   Used in Belsley, Kuh & Welsch, 'Regression diagnostics\n...', Wiley, 1980.   N.B. Various transformations are used in the table on\npages 244-261 of the latter.\n\nThe Boston house-price data has been used in many machine learning papers that address regression\nproblems.   \n     \n.. topic:: References\n\n   - Belsley, Kuh & Welsch, 'Regression diagnostics: Identifying Influential Data and Sources of Collinearity', Wiley, 1980. 244-261.\n   - Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning. In Proceedings on the Tenth International Conference of Machine Learning, 236-243, University of Massachusetts, Amherst. Morgan Kaufmann.\n\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"X=bostan['data']\nY=bostan['target']","execution_count":33,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.model_selection import train_test_split\nX_train,X_test,Y_train,Y_test=train_test_split(X,Y,train_size=0.7,random_state=12345)","execution_count":34,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nsc.fit(X_train)","execution_count":35,"outputs":[{"output_type":"execute_result","execution_count":35,"data":{"text/plain":"StandardScaler(copy=True, with_mean=True, with_std=True)"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"sc.mean_","execution_count":36,"outputs":[{"output_type":"execute_result","execution_count":36,"data":{"text/plain":"array([3.94714607e+00, 1.08940678e+01, 1.12309322e+01, 7.62711864e-02,\n       5.58416949e-01, 6.30809040e+00, 6.96237288e+01, 3.73936638e+00,\n       9.77683616e+00, 4.08491525e+02, 1.84855932e+01, 3.58925311e+02,\n       1.28601412e+01])"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"all(sc.mean_==X_train.mean(axis=0))","execution_count":37,"outputs":[{"output_type":"execute_result","execution_count":37,"data":{"text/plain":"True"},"metadata":{}}]},{"metadata":{},"cell_type":"markdown","source":"Be careful.Always implement the same transformation on the TEST as it is done in TRAIN data."},{"metadata":{"trusted":true},"cell_type":"code","source":"X_train_scaled=sc.transform(X_train)\nX_test_scaled=sc.transform(X_test)","execution_count":38,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.linear_model import LinearRegression\nlm=LinearRegression()","execution_count":39,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"lm.fit(X_train_scaled,Y_train)","execution_count":40,"outputs":[{"output_type":"execute_result","execution_count":40,"data":{"text/plain":"LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"lm.predict(X_test_scaled)","execution_count":41,"outputs":[{"output_type":"execute_result","execution_count":41,"data":{"text/plain":"array([24.62860328, 31.43146344, 20.53373048, 22.81602307, 16.61078275,\n       14.20624694, 26.99845314, 25.29412803, 32.22704835, 16.51487875,\n       24.47997677, 16.82721912, 28.15235804, 16.37601235, 20.26289868,\n       20.58322508, 20.97141932, 32.91007001, 10.82028141, 17.37567156,\n       22.0130247 , 20.0179169 ,  8.39695378, 25.46119824, 32.10968243,\n       31.0255735 , 15.0333021 , 27.637542  , 16.98241059, 17.43478799,\n       28.11979908, 19.66467502, 13.90862267,  9.85705677, 14.15373084,\n       25.42886277, 30.63166049, 19.89815629, 31.52120152, 21.7289929 ,\n       28.09411243, 14.53951498, 29.46794746, 17.45888399, 33.36168851,\n       27.9260773 , 27.97834652, 23.36943228, 17.50474163, 10.03388516,\n       20.52168936, 19.57322738, 18.51073194, 19.7856512 , 33.67700275,\n       19.98598573, 19.6225919 , 36.65169088, 17.48661305, 37.08004893,\n       22.73345101, 19.19850775, 13.37709597, 17.1215706 , 15.10696769,\n       33.92589496, 25.47413961, 36.64998069, 16.20779743, 34.40458137,\n        8.56667947, 27.82185252, 21.9642193 , 29.45061242, 19.12908534,\n       32.82532587, 31.71014443, 14.88583007, 27.06173702, 14.65063279,\n       20.28145468, 11.3651219 , 25.02973712, 24.28838571, 17.16472057,\n       17.81174196, 19.00490826, 20.96190425, 21.32165701, 19.43711345,\n        5.85439465, 28.79385697, 19.98569475, 12.95252009, 21.35694749,\n       42.94560881, 20.0305701 , 28.23046985, 24.34229411, 30.41288136,\n       16.42787534, 28.65884124, 28.56588382, 27.23768527, 24.17226534,\n       21.09189255, 15.38836379, 44.16926246,  5.90972567, 16.81985259,\n       33.71022006,  3.77429662, 26.10657369, 20.59125026, 28.35423685,\n       24.9693462 , 25.54215058, 17.77452592, 23.22150152, 24.68666032,\n       19.58343031, 12.45263225,  6.16052269, 26.4076262 , 33.01862583,\n       15.75847368, 21.66287385, 33.29526393, 25.29839456, 17.11165047,\n       15.62320933, 32.23679537, 22.73506554, 22.09802537, 21.6594604 ,\n       32.45310552, 19.31692314, 32.76901777, 40.99112918, 24.00984574,\n       36.39721378, 24.20858959,  2.49372524, 21.44617342, 17.80124708,\n       16.08533354, 28.56909711, 22.72935848, 19.08403621, 10.9733953 ,\n       30.7403639 , 15.83290961])"},"metadata":{}}]},{"metadata":{},"cell_type":"markdown","source":"# Measure the performance of your linear model using Regression Performance Metrics"},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.metrics import mean_absolute_error,mean_squared_error,r2_score","execution_count":42,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"y_pred=lm.predict(X_test_scaled)\nr2_score(Y_test,y_pred)","execution_count":43,"outputs":[{"output_type":"execute_result","execution_count":43,"data":{"text/plain":"0.6922062861008873"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"mean_absolute_error(Y_test,y_pred)","execution_count":44,"outputs":[{"output_type":"execute_result","execution_count":44,"data":{"text/plain":"3.298428632984369"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"mean_squared_error(Y_test,y_pred)","execution_count":45,"outputs":[{"output_type":"execute_result","execution_count":45,"data":{"text/plain":"21.767979165646494"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"lm.coef_.round(2)","execution_count":46,"outputs":[{"output_type":"execute_result","execution_count":46,"data":{"text/plain":"array([-1.06,  0.96,  0.03,  0.83, -2.02,  3.31, -0.18, -2.79,  2.47,\n       -1.99, -2.11,  0.64, -3.17])"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"np.abs(pd.Series({k:v for k,v in zip(bostan.feature_names,lm.coef_.round(2))})).sort_values(ascending=False)","execution_count":47,"outputs":[{"output_type":"execute_result","execution_count":47,"data":{"text/plain":"RM         3.31\nLSTAT      3.17\nDIS        2.79\nRAD        2.47\nPTRATIO    2.11\nNOX        2.02\nTAX        1.99\nCRIM       1.06\nZN         0.96\nCHAS       0.83\nB          0.64\nAGE        0.18\nINDUS      0.03\ndtype: float64"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"lm.intercept_","execution_count":48,"outputs":[{"output_type":"execute_result","execution_count":48,"data":{"text/plain":"22.586158192090423"},"metadata":{}}]},{"metadata":{},"cell_type":"markdown","source":"# Feature Selection"},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.feature_selection import SelectKBest,f_regression,f_classif","execution_count":49,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"#f_regression is for getting significance and predictive power of each X variable\nprint(list(f_regression(X_train_scaled,Y_train)))","execution_count":50,"outputs":[{"output_type":"stream","text":"[array([ 65.68619964,  65.74663609, 134.87092524,   7.83804166,\n        81.96366268, 376.85156539,  62.57012451,  27.44242349,\n        59.86695205, 102.19357251, 140.66856333,  38.67471252,\n       401.73625629]), array([8.82248867e-15, 8.59744681e-15, 1.29013645e-26, 5.39788973e-03,\n       9.65770668e-18, 1.37241337e-57, 3.36192342e-14, 2.79275675e-07,\n       1.08266481e-13, 2.91901559e-21, 1.58261883e-27, 1.41919124e-09,\n       3.67133772e-60])]\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"print(pd.DataFrame(list(f_regression(X_train_scaled,Y_train)),index=['Fscores','Pvalues'],\n                   columns=bostan.feature_names).T.sort_values('Fscores',ascending=False)\n     )","execution_count":55,"outputs":[{"output_type":"stream","text":"            Fscores       Pvalues\nLSTAT    401.736256  3.671338e-60\nRM       376.851565  1.372413e-57\nPTRATIO  140.668563  1.582619e-27\nINDUS    134.870925  1.290136e-26\nTAX      102.193573  2.919016e-21\nNOX       81.963663  9.657707e-18\nZN        65.746636  8.597447e-15\nCRIM      65.686200  8.822489e-15\nAGE       62.570125  3.361923e-14\nRAD       59.866952  1.082665e-13\nB         38.674713  1.419191e-09\nDIS       27.442423  2.792757e-07\nCHAS       7.838042  5.397890e-03\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"SelectKBest?","execution_count":56,"outputs":[]},{"metadata":{"trusted":true},"cell_type":"code","source":"skb=SelectKBest(k=5,score_func=f_regression)\nskb.fit(X_train,Y_train)\nskb.transform(X_train)\nselected_features=bostan.feature_names[skb.get_support()]\nprint(pd.DataFrame(data={'Pvalue':skb.pvalues_,'FScores':skb.scores_},index=bostan.feature_names).loc[selected_features,:].sort_values('FScores',ascending=False).round(3))","execution_count":62,"outputs":[{"output_type":"stream","text":"         Pvalue  FScores\nLSTAT       0.0  401.736\nRM          0.0  376.852\nPTRATIO     0.0  140.669\nINDUS       0.0  134.871\nTAX         0.0  102.194\n","name":"stdout"}]},{"metadata":{},"cell_type":"markdown","source":"# PCA"},{"metadata":{"trusted":true},"cell_type":"code","source":"from sklearn.decomposition import PCA\npca=PCA(n_components=2)\nX_pca=pca.fit_transform(X_train)\n#X_pca.dtype","execution_count":65,"outputs":[{"output_type":"execute_result","execution_count":65,"data":{"text/plain":"dtype('float64')"},"metadata":{}}]},{"metadata":{"trusted":true},"cell_type":"code","source":"pd.DataFrame(X_pca,columns=['comp1','comp2']).plot.scatter(x='comp1',y='comp2')","execution_count":67,"outputs":[{"output_type":"execute_result","execution_count":67,"data":{"text/plain":"<matplotlib.axes._subplots.AxesSubplot at 0x7fdce2d39cc0>"},"metadata":{}},{"output_type":"display_data","data":{"text/plain":"<Figure size 432x288 with 1 Axes>","image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"metadata":{},"cell_type":"markdown","source":"# To get R -like Results for a Linear Regression"},{"metadata":{"trusted":true},"cell_type":"code","source":"import statsmodels.api as sm\nols=sm.OLS(Y_train,X_train).fit()\n#ols=sm.add_constant(1)\nprint(ols.summary())\n","execution_count":75,"outputs":[{"output_type":"stream","text":"                                 OLS Regression Results                                \n=======================================================================================\nDep. Variable:                      y   R-squared (uncentered):                   0.960\nModel:                            OLS   Adj. R-squared (uncentered):              0.959\nMethod:                 Least Squares   F-statistic:                              630.4\nDate:                Wed, 22 Apr 2020   Prob (F-statistic):                   2.10e-229\nTime:                        05:48:55   Log-Likelihood:                         -1064.7\nNo. Observations:                 354   AIC:                                      2155.\nDf Residuals:                     341   BIC:                                      2206.\nDf Model:                          13                                                  \nCovariance Type:            nonrobust                                                  \n==============================================================================\n                 coef    std err          t      P>|t|      [0.025      0.975]\n------------------------------------------------------------------------------\nx1            -0.1079      0.037     -2.885      0.004      -0.181      -0.034\nx2             0.0464      0.018      2.551      0.011       0.011       0.082\nx3            -0.0219      0.077     -0.285      0.776      -0.173       0.129\nx4             3.2538      1.029      3.163      0.002       1.230       5.277\nx5            -4.7401      4.036     -1.174      0.241     -12.679       3.199\nx6             6.5233      0.374     17.454      0.000       5.788       7.258\nx7            -0.0159      0.018     -0.906      0.366      -0.051       0.019\nx8            -0.9591      0.242     -3.969      0.000      -1.434      -0.484\nx9             0.1554      0.083      1.867      0.063      -0.008       0.319\nx10           -0.0097      0.005     -1.951      0.052      -0.019    7.77e-05\nx11           -0.5038      0.142     -3.555      0.000      -0.782      -0.225\nx12            0.0125      0.003      3.853      0.000       0.006       0.019\nx13           -0.3194      0.063     -5.092      0.000      -0.443      -0.196\n==============================================================================\nOmnibus:                      156.103   Durbin-Watson:                   2.076\nProb(Omnibus):                  0.000   Jarque-Bera (JB):             1144.321\nSkew:                           1.680   Prob(JB):                    3.27e-249\nKurtosis:                      11.142   Cond. No.                     8.56e+03\n==============================================================================\n\nWarnings:\n[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n[2] The condition number is large, 8.56e+03. This might indicate that there are\nstrong multicollinearity or other numerical problems.\n","name":"stdout"}]},{"metadata":{"trusted":true},"cell_type":"code","source":"","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"language":"python","display_name":"Python 3","name":"python3"},"language_info":{"pygments_lexer":"ipython3","nbconvert_exporter":"python","version":"3.6.4","file_extension":".py","codemirror_mode":{"name":"ipython","version":3},"name":"python","mimetype":"text/x-python"}},"nbformat":4,"nbformat_minor":4}